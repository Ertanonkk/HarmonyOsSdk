"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_newArrowCheck2=_interopRequireDefault(require("@babel/runtime/helpers/newArrowCheck")),_util=require("./util"),_parser=require("./parser"),compiler=require("./lite/lite-transform-template"),_require=require("./lite/lite-enum"),DEVICE_LEVEL=_require.DEVICE_LEVEL;module.exports=function(e){var r=this;if(process.env.DEVICE_LEVEL!==DEVICE_LEVEL.RICH&&e.lastIndexOf("</element>")>0){var t=e.lastIndexOf("</element>");e=e.substr(t+10,e.length)}this.cacheable&&this.cacheable();var i=this.async(),l=!1;(0,_parser.parseTemplate)(e,this.resourcePath).then(function(e){var t=e.parsed,n=e.log;(0,_newArrowCheck2.default)(this,r),n&&n.length&&(l=(0,_util.logWarn)(this,n)),process.env.DEVICE_LEVEL===DEVICE_LEVEL.LITE&&(t=l?"function () { return {} }":compiler.transformTemplate(t)),i(null,t)}.bind(this)).catch(function(e){(0,_newArrowCheck2.default)(this,r),(0,_util.logWarn)(this,[{reason:"ERROR: Failed to parse the HML file. "+e}]),i("")}.bind(this))};