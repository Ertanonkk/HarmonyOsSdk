(()=>{"use strict";var e={784:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.errorMap=void 0,t.errorMap=new Map([["fileError","Visual file is damaged"],["versionError","Version number of visual file does not match"],["modelError","Visual model in visual file is damaged"],["codegenError","Codegen hml and css failed"]])},117:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ASTNode=void 0;t.ASTNode=class{accept(e){return e.visit(this)}}},862:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Cache=void 0;t.Cache=class{constructor(e){this.value="",this.indent=0,this.flag=!0,this.INDENT=e}indentOn(){this.flag=!0}indentOff(){this.flag=!1}incIndent(){this.indent++}decIndent(){this.indent--}checkIndent(){return this.indent<0}getIndents(){if(this.flag){let e="";for(let t=0;t<this.indent;t++)e+=this.INDENT;return e}return""}concat(...e){return this.value+=this.getIndents(),this.value=this.value.concat(...e),String(this.value)}toString(){return this.value}}},243:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Style=t.Tag=void 0;const n=o(117);t.Tag=class extends n.ASTNode{constructor(e,t,o){super(),this.tagName=e,this.attributes=t,this.content=o}};t.Style=class extends n.ASTNode{constructor(e,t,o){super(),this.kind=e,this.name=t,this.content=o}}},573:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ASTNodeGenerator=void 0;const n=o(243),r=o(334);class i{constructor(e){this.cache=e}visit(e){e instanceof n.Tag?this.genTag(e):e instanceof n.Style&&this.genStyle(e)}static getMethodGen(e){return void 0===i.instance?i.instance=new i(e):i.instance.setCache(e),i.instance}setCache(e){this.cache=e}genTag(e){if(this.cache.concat(r.TokenClass.TAG_START,e.tagName),this.cache.indentOff(),e.attributes.forEach((e,t)=>{let o="";for(const t of e)o+='"'===t?"&quot;":"\n"===t?"&#10;":t;this.cache.concat(r.TokenClass.SPACE,t,r.TokenClass.ASSIGN,r.TokenClass.LQUOTE,o,r.TokenClass.RQUOTE)}),null===e.content)this.cache.concat(r.TokenClass.EMPTY_TAG_END);else{if(this.cache.concat(r.TokenClass.TAG_END),"string"==typeof e.content){let t="";for(const o of e.content)t+="<"===o?"&#60;":o;this.cache.concat(t)}else 0!==e.content.length&&(this.cache.concat(r.TokenClass.NEW_LINE),this.cache.indentOn(),this.cache.incIndent(),e.content.forEach(e=>{e.accept(this),this.cache.indentOff(),this.cache.concat(r.TokenClass.NEW_LINE),this.cache.indentOn()}),this.cache.decIndent(),this.cache.indentOn());this.cache.concat(r.TokenClass.END_TAG_START,e.tagName,r.TokenClass.TAG_END)}}genStyle(e){"IDStyle"===e.kind&&(this.cache.concat(r.TokenClass.ID_STYLE_START),this.cache.indentOff()),this.cache.concat(e.name,r.TokenClass.SPACE,r.TokenClass.LBRA,r.TokenClass.NEW_LINE),this.cache.indentOn(),this.cache.incIndent(),e.content.forEach((e,t)=>{this.cache.concat(t,r.TokenClass.COLON,r.TokenClass.SPACE,e,r.TokenClass.SEMICOLON,r.TokenClass.NEW_LINE)}),this.cache.decIndent(),this.cache.concat(r.TokenClass.RBRA,r.TokenClass.NEW_LINE,r.TokenClass.NEW_LINE)}}t.ASTNodeGenerator=i,i.instance=void 0},844:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CSSBridge=t.HMLBridge=void 0;const n=o(243),r=o(571);t.HMLBridge=class{constructor(){this.errors=0}error(e){console.error("Code generating error: "+e),this.errors+=1}getErrorCount(){return this.errors}visit(e){const t=new Map([["id",e.id]]);let o="";for(let[n,i]of e.property)r.isAttribute(n)?("string"!=typeof i&&(i=JSON.stringify(i)),t.set(n,i)):r.isContent(n)&&(o=i);if(e.children.length>0){o=[];for(const t of e.children)o.push(t.accept(this))}return new n.Tag(e.type,t,o)}};t.CSSBridge=class{constructor(){this.errors=0,this.styles=[]}error(e){console.error("Code generating error: "+e),this.errors+=1}getErrorCount(){return this.errors}genIDStyle(e){const t=new Map;for(const o of r.styleSet)e.property.has(o)&&r.isStyle(o)&&t.set(o,e.property.get(o));t.size>0&&this.styles.push(new n.Style("IDStyle",e.id,t));for(const t of e.children)t.accept(this)}visit(e){return this.genIDStyle(e),this.styles}}},55:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.genFACSS=t.genFAHML=void 0;const n=o(573),r=o(862);t.genFAHML=function(e){const t=n.ASTNodeGenerator.getMethodGen(new r.Cache("    "));return e.accept(t),t.cache.toString()},t.genFACSS=function(e){const t=n.ASTNodeGenerator.getMethodGen(new r.Cache("    "));return e.forEach(e=>{e.accept(t)}),t.cache.toString()}},571:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isEvent=t.isData=t.isUnknown=t.isContent=t.isAttribute=t.isStyle=t.styleSet=void 0;const o=["background-color",...["background","background-image","background-size","background-position","background-repeat"]],n=[...["width","height","min-width","min-height","max-width","max-height"],...["padding","padding-start","padding-end","padding-top","padding-right","padding-bottom","padding-left"],...["margin","margin-start","margin-end","margin-top","margin-right","margin-bottom","margin-left"],...["border-width","border-style","border-color","border-radius","border-top-width","border-top-style","border-top-color","border-top-left-radius","border-right-width","border-right-style","border-right-color","border-top-right-radius","border-bottom-width","border-bottom-style","border-bottom-color","border-bottom-right-radius","border-left-width","border-left-style","border-left-color","border-bottom-left-radius"],...o,...["display","opacity","visibility"],...["flex","flex-grow","flex-shrink","flex-basis"],...["position","display","top","right","bottom","left"],...["display-index","flex-weight","aspect-ratio"]],r=["font-size","font-family","font-style","font-weight"],i=["flex-direction",...["flex-wrap","justify-content","align-items","align-content"]],s=["text-align","line-height","text-decoration","letter-spacing","max-lines","text-overflow","allow-scale","min-font-size","max-font-size","font-size-step","prefer-font-sizes",...r],a=["allow-scale","text-decoration","color",...r],c=["text-color","allow-scale","icon-width","icon-height","radius",...r],l=["texton-color","textoff-color","text-padding","allow-scale",...r],d=["column-height","text-color","allow-scale","letter-spacing","text-decoration","line-height","opacity",...r];t.styleSet=new Set([...n,...i,...s,...["object-fit","match-text-direction","fit-original-size"],...a,...["font-size","font-family","font-weight","color","placeholder-color","allow-scale"],...c,...l,...["progress-color"],...["stroke-width","line-cap"],...["stroke-width","radius","start-angle","total-angle","center-x","center-y","colors","weights"],...d,...["color","selected-color","block-color"],...["indicator-color","indicator-selected-color","indicator-size","indicator-top","indicator-right","indicator-bottom","indicator-left"],...["flex-direction","columns","item-extent","fade-color"],...["column-span"],...["color","stroke-width","background-color","secondary-color","scale-width","scale-number","start-angle","total-angle","center-x","center-y","radius"],...["grid-template-columns","grid-template-rows","grid-row-start","grid-row-end","grid-column-start","grid-column-end","grid-gap","grid-columns-gap","grid-rows-gap"]]);const h=new Set([...["id","ref","disabled","focusable","data","if","for"],...["src","alt"],...["type","value","icon","waiting"],...["offset","refreshing","type","lasttime","friction"],...["type","checked","name","value","placeholder","maxlength","enterkeytype","headericon"],...["checked","showtext","texton","textoff"],...["value"],...["percent","datasets","options"],...["range","selected","start","end","lunar","lunarSwitch","columns","hours","containSecond"],...["min","max","step","showtips","showsteps","mode"],...["vertical"],...["scrollpage","cachedcount","scrollbar","scrolleffect","shapemode","indexer","itemscale","itemcenter","updateeffect","scrollvibrate","initialindex","initialoffset"],...["for","type","primary","section","sticky","stickyradius","clickeffect"],...["index","autoplay","interval","indicator","digital","indicatordisabled","loop","duration","vertical"],...["type","percent","secondarypercent","clockwise"],...["target","title"],...["clockconfig","showdigit","hourswest"]]),u=new Set([...["ontouchstart","ontouchmove","ontouchcancel","ontouchend","onclick","onlongpress","onfocus","onblur","onkey","onswipe"],...["oncomplete","onerror"],...["onchange","onenterkeyclick"],...["onchange"],...["onrefresh","onpulldown"],...["change","onrotation"],...["onindexerchange","onscroll","onscrollbottom","onscrolltop","onscrollend","onscrolltouchup","onrequestitem"],...["onsticky"],...["onselected","oncancel"],...["oncolumnchange"]]);function p(e){return t.styleSet.has(e)}function f(e){return h.has(e)||u.has(e)}t.isStyle=p,t.isAttribute=f,t.isContent=function(e){return"content"===e},t.isUnknown=function(e){return!p(e)&&!f(e)},t.isData=function(e){return h.has(e)},t.isEvent=function(e){return u.has(e)}},334:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TokenClass=void 0,function(e){e[e.IDENTIFIER=0]="IDENTIFIER",e[e.STRING_LITERAL=1]="STRING_LITERAL",e[e.NUMBER=2]="NUMBER",e[e.CHARACTER=3]="CHARACTER",e[e.EOF=4]="EOF",e[e.INVALID=5]="INVALID",e.EMPTY_DATA="empty",e.ASSIGN="=",e.NEW_LINE="\n",e.CARRIAGE_RETURN="\r",e.INDENT="    ",e.SPACE=" ",e.LQUOTE='"',e.RQUOTE='"',e.TAG_START="<",e.TAG_END=">",e.EMPTY_TAG_END="/>",e.END_TAG_START="</",e.ID_STYLE_START="#",e.CLASS_STYLE_START=".",e.LBRA="{",e.RBRA="}",e.SEMICOLON=";",e.COLON=":"}(t.TokenClass||(t.TokenClass={}))},234:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Enum=t.Characteristic=t.Event=t.Service=t.Device=void 0;t.Device=class{constructor(){this.prodId="",this.udid="",this.deviceModel="",this.deviceName="",this.deviceTypeId="",this.deviceTypeName="",this.manufacturerId="",this.manufacturerName="",this.services=[]}};t.Service=class{constructor(){this.serviceId="",this.serviceType="",this.characteristics=[]}};t.Event=class{constructor(){this.eventId="",this.eventType="",this.characteristics=[]}};t.Characteristic=class{constructor(){this.name="",this.type="",this.format="int",this.method=[]}};t.Enum=class{constructor(){this.enumVal="",this.description={}}}},207:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formManager=void 0;const n=o(891),r=o(945);t.formManager={removeData(e){this.getFormModel().data.delete(e)},addData(e){e instanceof Map?e.forEach((e,t)=>{this.getFormModel().data.set(t,e)}):Object.keys(e).forEach(t=>{this.getFormModel().data.set(t,e[t])})},updateAllData(e){this.getFormModel().data.clear(),this.addData(e)},addAction(e,t,o,n){const i=new Map;Object.keys(o).forEach(e=>{i.set(e,o[e])}),this.getFormModel().actions.set(e,new r.FormAction(t,i,n))},updateAllActions(e){this.getFormModel().actions.clear(),e.forEach((e,t)=>{const o=this.objectToMap(e.params),n=new r.FormAction(e.actionType,o,e.abilityName);this.getFormModel().actions.set(t,n)})},removeAction(e){this.getFormModel().actions.delete(e)},addActionParams(e,t){var o,n;const i=null!==(o=this.getFormModel().actions.get(e))&&void 0!==o?o:new r.FormAction(e),s=null!==(n=i.params)&&void 0!==n?n:new Map;Object.keys(t).forEach(e=>{s.set(e,t[e])}),i.params=s},removeActionParam(e,t){var o;const n=this.getFormModel().actions.get(e);null===(o=null===n||void 0===n?void 0:n.params)||void 0===o||o.delete(t)},getFormModel:()=>n.getInstance().formData,codegenToJson:function(){const e=n.getInstance().formData,t=this.mapToObject(e.data),o=this.mapToObject(e.actions),r={actions:{},data:{}};return r.data=t,r.actions=o,e.actions.forEach((e,t)=>{r.actions[t].params=this.mapToObject(e.params)}),JSON.stringify(r,null,4)},clear(){n.getInstance().formData.data.clear(),n.getInstance().formData.actions.clear()},mapToObject:e=>void 0===e?{}:Array.from(e.entries()).reduce((e,[t,o])=>Object.assign(Object.assign({},e),{[t]:o}),{}),objectToMap(e){const t=new Map;return Object.keys(e).forEach((o,n)=>{t.set(o,e[o])}),t}}},945:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FormAction=t.FormModel=void 0;t.FormModel=class{constructor(){this.data=new Map,this.actions=new Map}};t.FormAction=class{constructor(e,t,o){this.action=e,this.abilityName=o,this.params=t}}},964:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isBindingEvent=t.CombinedSelfType=void 0,function(e){e[e.None=0]="None",e[e.Root=1]="Root",e[e.Container=2]="Container",e[e.Active=4]="Active"}(t.CombinedSelfType||(t.CombinedSelfType={})),t.isBindingEvent=function(e){return void 0!==e&&"string"==typeof e.type&&"string"==typeof e.physicalModelName}},891:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addPhysicalModel=t.getPhysicalModel=t.setInstance=t.getInstance=void 0;const n=o(234),r=o(933),i=o(945),s={document:{VisualVersion:"12",type:"FA"},visualModel:new r.VisualModel({type:"div",id:"wrapper"}),harmonyConnectDevice:new n.Device,formData:new i.FormModel};function a(){return s}t.getInstance=a,t.setInstance=function(e){for(const t in s)Object.prototype.hasOwnProperty.call(e,t)&&(s[t]=e[t])},t.getPhysicalModel=function(e){const t=a().harmonyConnectDevice.services.find(t=>t.serviceId===e.serviceId);if(void 0!==t)return t.characteristics.find(t=>t.name===e.characteristicName)},t.addPhysicalModel=function(e){const t=a().harmonyConnectDevice,o=t.services.find(t=>t.serviceId===e.serviceId);if(void 0===o)t.services.push(e);else for(const t of e.characteristics)o.characteristics.every(e=>e.name!==t.name)&&o.characteristics.push(t)}},977:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deserialize=t.serialize=void 0;const n=o(933),r=o(891);function i(e,t){if(t instanceof Map)return{dataType:"Map",value:Object.fromEntries(t.entries())};if(t instanceof Set)return{dataType:"Set",value:Array.from(t.entries())};if(t instanceof n.VisualModel){const e=new n.VisualModel({type:"none"}),o={};for(const n in e)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=t[n]);return{dataType:"VisualModel",value:o}}return t}function s(e,t){if("object"==typeof t&&null!==t&&void 0!==t){if("Map"===t.dataType)return new Map(Object.entries(t.value));if("Set"===t.dataType)return new Set(t.value);if("VisualModel"===t.dataType){const e=new n.VisualModel({type:""});Object.assign(e,t.value),t=e}}return t}t.serialize=function(){return JSON.stringify(r.getInstance(),i)},t.deserialize=function(e){const t=JSON.parse(e,s);r.setInstance(t)}},933:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VisualModel=void 0;const n=o(964),r="-visual";t.VisualModel=class{constructor(e){if(this.property=void 0!==e.property?e.property:new Map,this.children=void 0!==e.children?e.children:[],this.physicalModel=e.physicalModel,"wrapper"===e.type)return this.id="wrapper",void(this.type="div");e.type.endsWith(r)&&(e.type=e.type.substring(0,e.type.length-r.length)),this.id=void 0!==e.id?e.id:"",this.type=e.type,void 0===e.combinedSelfType&&void 0===e.data&&void 0===e.event||(this.combinedInfo={id:"",type:"",selfType:void 0===e.combinedSelfType?n.CombinedSelfType.None:e.combinedSelfType,data:e.data,event:e.event})}accept(e){return e.visit(this)}}}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,o),i.exports}var n={};(()=>{var e=n;Object.defineProperty(e,"__esModule",{value:!0});const t=o(784),r=o(891),i=o(977),s=o(844),a=o(55),c=o(207),l=12;e.genHmlAndCss=function(e){const o={hmlCss:{hml:"",css:"",json:""},errorType:"",errorMessage:""};try{i.deserialize(e);const t=r.getInstance().document.VisualVersion,n=/^([1-9]+[0-9]*)$/;if(void 0===t)o.errorType="versionError";else{const e=t.match(n);(null===e||parseInt(e[1])>l)&&(o.errorType="versionError")}try{const e=function(e){const t={hml:"",css:"",json:""},o=new s.HMLBridge,n=e.accept(o),r=a.genFAHML(n);o.getErrorCount()>0?t.hml="error":t.hml=r;const i=new s.CSSBridge,c=e.accept(i),l=a.genFACSS(c);return i.getErrorCount()>0?t.css="error":t.css=l,t}(r.getInstance().visualModel);"error"!==e.hml&&"error"!==e.css||(o.errorType="codegenError"),o.hmlCss=e,"FORM"===r.getInstance().document.type&&(o.hmlCss.json=c.formManager.codegenToJson())}catch(e){o.errorType="modelError"}}catch(e){o.errorType="fileError"}return""!==o.errorType&&(o.errorMessage=t.errorMap.get(o.errorType),o.hmlCss.hml="",o.hmlCss.css=""),o}})();var r=exports;for(var i in n)r[i]=n[i];n.__esModule&&Object.defineProperty(r,"__esModule",{value:!0})})();