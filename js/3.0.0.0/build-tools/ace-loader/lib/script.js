"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_newArrowCheck2=_interopRequireDefault(require("@babel/runtime/helpers/newArrowCheck")),_path=_interopRequireDefault(require("path")),_util=require("./util"),_parser=require("./parser"),_require=require("./lite/lite-enum"),DEVICE_LEVEL=_require.DEVICE_LEVEL;module.exports=function(e,r){var t=this;this.cacheable&&this.cacheable();var a=this.async();(0,_parser.parseScript)(e,this.resourcePath).then(function(e){var n=e.parsed,c=e.log;if((0,_newArrowCheck2.default)(this,t),c&&c.length&&(0,_util.logWarn)(this,c),n=(0,_util.parseRequireModule)(n),process.env.DEVICE_LEVEL===DEVICE_LEVEL.RICH){var o="page"===process.env.abilityType?"app.js":"".concat(process.env.abilityType,".js");_path.default.basename(this.resourcePath)!==o&&(n+="\nvar moduleOwn = exports.default || module.exports;\nvar accessors = ['public', 'protected', 'private'];\nif (moduleOwn.data && accessors.some(function (acc) {\n    return moduleOwn[acc];\n  })) {\n  throw new Error('For VM objects, attribute data must not coexist with public, protected, or private. Please replace data with public.');\n} else if (!moduleOwn.data) {\n  moduleOwn.data = {};\n  moduleOwn._descriptor = {};\n  accessors.forEach(function(acc) {\n    var accType = typeof moduleOwn[acc];\n    if (accType === 'object') {\n      moduleOwn.data = Object.assign(moduleOwn.data, moduleOwn[acc]);\n      for (var name in moduleOwn[acc]) {\n        moduleOwn._descriptor[name] = {access : acc};\n      }\n    } else if (accType === 'function') {\n      console.warn('For VM objects, attribute ' + acc + ' value must not be a function. Change the value to an object.');\n    }\n  });\n}");var i="module.exports = function(module, exports, $app_require$){".concat(n,"}");a(null,i+="\n/* generated by ace-loader */\n",r)}process.env.DEVICE_LEVEL===DEVICE_LEVEL.LITE&&a(null,n,r)}.bind(this)).catch(function(e){(0,_newArrowCheck2.default)(this,t),(0,_util.logWarn)(this,[{reason:"ERROR: Failed to parse the JS file. "+e}]),a("")}.bind(this))};