(()=>{"use strict";var e={784:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.errorMap=void 0,t.errorMap=new Map([["fileError","Visual file is damaged"],["versionError","Version number of visual file does not match"],["modelError","Visual model in visual file is damaged"],["codegenError","Codegen hml and css failed"]])},243:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Style=t.Tag=void 0;t.Tag=class{constructor(e,t,n){this.tagName=e,this.attributes=t,this.content=n}accept(e){return e.genTag(this)}};t.Style=class{constructor(e,t,n){this.kind=e,this.name=t,this.content=n}accept(e){return e.genStyle(this)}}},245:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StringWriter=void 0;const r=n(573),s=n(695);t.StringWriter=class{constructor(){this.generator=r.ASTNodeGenerator.getMethodGen(new s.Cache(""))}genHML(e){return e.accept(this.generator),this.generator.cache.toString()}genCSS(e){return e.forEach(e=>{e.accept(this.generator)}),this.generator.cache.toString()}}},573:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ASTNodeGenerator=void 0;const r=n(334);class s{constructor(e){this.cache=e}static getMethodGen(e){return void 0===s.instance?s.instance=new s(e):s.instance.setCache(e),s.instance}setCache(e){this.cache=e}genTag(e){if(this.cache.concat(r.TokenClass.TAG_START,e.tagName),this.cache.indentOff(),e.attributes.forEach((e,t)=>{let n="";for(const t of e)n+='"'===t?"&quot;":"\n"===t?"&#10;":t;this.cache.concat(r.TokenClass.SPACE,t,r.TokenClass.ASSIGN,r.TokenClass.LQUOTE,n,r.TokenClass.RQUOTE)}),null===e.content)this.cache.concat(r.TokenClass.EMPTY_TAG_END);else{if(this.cache.concat(r.TokenClass.TAG_END),"string"==typeof e.content){let t="";for(const n of e.content)t+="<"===n?"&#60;":"\n"===n?"&#10;":n;this.cache.concat(t)}else 0!==e.content.length&&(this.cache.concat(r.TokenClass.NEW_LINE),this.cache.indentOn(),this.cache.incIndent(),e.content.forEach(e=>{e.accept(this),this.cache.indentOff(),this.cache.concat(r.TokenClass.NEW_LINE),this.cache.indentOn()}),this.cache.decIndent(),this.cache.indentOn());this.cache.concat(r.TokenClass.END_TAG_START,e.tagName,r.TokenClass.TAG_END)}}genStyle(e){"IDStyle"===e.kind&&(this.cache.concat(r.TokenClass.ID_STYLE_START),this.cache.indentOff()),this.cache.concat(e.name,r.TokenClass.SPACE,r.TokenClass.LBRA,r.TokenClass.NEW_LINE),this.cache.indentOn(),this.cache.incIndent(),e.content.forEach((e,t)=>{this.cache.concat(t,r.TokenClass.COLON,r.TokenClass.SPACE,e,r.TokenClass.SEMICOLON,r.TokenClass.NEW_LINE)}),this.cache.decIndent(),this.cache.concat(r.TokenClass.RBRA,r.TokenClass.NEW_LINE,r.TokenClass.NEW_LINE)}}t.ASTNodeGenerator=s,s.instance=void 0},844:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CSSBridge=t.HMLBridge=void 0;const r=n(335),s=n(243);t.HMLBridge=class{constructor(){this.errors=0}error(e){console.error("Code generating error: "+e),this.errors+=1}getErrorCount(){return this.errors}genTag(e){let t=null;if(r.hasTextContent(e))t=e.content;else if(r.hasArrayContent(e)){const n=[];e.content.forEach(e=>{const t=e.accept(this);if(!(t instanceof s.Tag))throw new Error("WTF: what a trrrible failure");n.push(t)}),t=n}return new s.Tag(e.tagName,e.attributes,t)}visit(e){if(r.isHmlNode(e))return this.genTag(e);throw new Error("no return")}};t.CSSBridge=class{constructor(){this.errors=0,this.styles=[]}error(e){console.error("Code generating error: "+e),this.errors+=1}getErrorCount(){return this.errors}genIDStyle(e){if(e.idStyle.size>0&&this.styles.push(new s.Style("IDStyle",e.id,e.idStyle)),r.hasArrayContent(e))for(const t of e.content)t.accept(this)}genClassStyle(e){this.styles.push(new s.Style("ClassStyle",e.className,e.content))}visit(e){if(r.isHmlNode(e))return this.genIDStyle(e),this.styles;if(r.isClassStyle(e))return this.genClassStyle(e),this.styles;throw new Error("no return")}}},695:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Cache=void 0;const r=n(334);t.Cache=class{constructor(e){this.value=e,this.indent=0,this.flag=!0}indentOn(){this.flag=!0}indentOff(){this.flag=!1}incIndent(){this.indent++}decIndent(){this.indent--}checkIndent(){return this.indent<0}getIndents(){if(this.flag){let e="";return Array.from(Array(this.indent).keys()).forEach(t=>{e+=r.TokenClass.INDENT}),e}return""}concat(...e){return this.value+=this.getIndents(),this.value=this.value.concat(...e),String(this.value)}toString(){return this.value}}},334:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TokenClass=void 0,function(e){e[e.IDENTIFIER=0]="IDENTIFIER",e[e.STRING_LITERAL=1]="STRING_LITERAL",e[e.NUMBER=2]="NUMBER",e[e.CHARACTER=3]="CHARACTER",e[e.EOF=4]="EOF",e[e.INVALID=5]="INVALID",e.EMPTY_DATA="empty",e.ASSIGN="=",e.NEW_LINE="\n",e.CARRIAGE_RETURN="\r",e.INDENT="  ",e.SPACE=" ",e.LQUOTE='"',e.RQUOTE='"',e.TAG_START="<",e.TAG_END=">",e.EMPTY_TAG_END="/>",e.END_TAG_START="</",e.ID_STYLE_START="#",e.CLASS_STYLE_START=".",e.LBRA="{",e.RBRA="}",e.SEMICOLON=";",e.COLON=":"}(t.TokenClass||(t.TokenClass={}))},704:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.emit=t.emitCSS=t.emitHml=void 0;const r=n(844),s=n(245);function o(e){const t=new r.HMLBridge,n=e.accept(t),o=(new s.StringWriter).genHML(n);return t.getErrorCount()>0?(console.error("Cannot generate code, error found: "+t.getErrorCount().toString()),"error"):o}function i(e){const t=new r.CSSBridge,n=e.accept(t),o=(new s.StringWriter).genCSS(n);return t.getErrorCount()>0?(console.error("Cannot generate code, error found: "+t.getErrorCount().toString()),"error"):o}t.emitHml=o,t.emitCSS=i,t.emit=function(e){return{hml:o(e),css:i(e)}}},335:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasJsonTextContent=t.hasJsonArrayContent=t.isClassStyle=t.hasArrayContent=t.hasTextContent=t.isText=t.isHmlNode=t.isContainer=void 0,t.isContainer=function(e){return"Container"===e.type},t.isHmlNode=function(e){return"Container"===e.type||"TextContent"===e.type||"Base"===e.type||"Text"===e.type},t.isText=function(e){return"Text"===e.type},t.hasTextContent=function(e){return void 0!==e.content&&"string"==typeof e.content},t.hasArrayContent=function(e){return void 0!==e.content&&e.content instanceof Array},t.isClassStyle=function(e){return"ClassStyle"===e.kind},t.hasJsonArrayContent=function(e){return void 0!==e.content&&e.content instanceof Array},t.hasJsonTextContent=function(e){return void 0!==e.content&&"string"==typeof e.content}}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}var r={};(()=>{var e=r;Object.defineProperty(e,"__esModule",{value:!0});const t=n(335),s=n(704),o=n(784),i=10;e.genHmlAndCss=function(e){const n={hmlCss:{hml:"",css:""},errorType:"",errorMessage:""};try{const r=JSON.parse(e),o=r.VisualVersion,c=/^([1-9]+[0-9]*)$/;if(void 0===o)n.errorType="versionError";else{const e=o.match(c);(null===e||parseInt(e[1])>i)&&(n.errorType="versionError")}try{const e=function e(n){const r={id:n.id,tagName:n.tagName,type:n.type,idStyle:new Map(n.idStyle),attributes:new Map(n.attributes),accept:e=>e.visit(r)};if(t.hasJsonTextContent(n))r.content=n.content;else if(t.hasJsonArrayContent(n)){const t=[];for(const r of n.content)t.push(e(r));r.content=t}return r}(JSON.parse(r.content)),o=s.emit(e);"error"!==o.hml&&"error"!==o.css||(n.errorType="codegenError"),n.hmlCss=o}catch(e){n.errorType="modelError"}}catch(e){n.errorType="fileError"}return""!==n.errorType&&(n.errorMessage=o.errorMap.get(n.errorType),n.hmlCss.hml="",n.hmlCss.css=""),n}})();var s=exports;for(var o in r)s[o]=r[o];r.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();